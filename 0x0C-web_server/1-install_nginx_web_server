#!/usr/bin/env bash
# Update package lists
apt-get update

# Install Nginx
apt-get install -y nginx

# Create the index.html file with "Hello World!" content
echo "Hello World!" > /var/www/html/index.html

# Start Nginx service using init.d script
/etc/init.d/nginx start

# Ensure Nginx is running
if ! pgrep -x "nginx" > /dev/null
then
    echo "Nginx failed to start."
    exit 1
fi
# Ensure the firewall allows traffic on port 80
ufw allow 80/tcp

# Verify Nginx is running
if curl -s http://localhost | grep -q "Hello World!"; then
    echo "Nginx is serving the correct content."
else
    echo "Nginx is not serving the correct content."
    exit 1
fi
